---
title: "03_10_2021_Cluster_Shiny"
author: "E."
date: "5-10-2021"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(shiny)
library(dplyr)
library(tidyverse)

```

Data source: https://www.bpb.de/nachschlagen/zahlen-und-fakten/soziale-situation-in-deutschland/61911/downloads
Git: use_github(protocol = 'https', auth_token = Sys.getenv("GITHUB_PAT"))

```{r mainBody, include=FALSE}

trend_data <- read_delim("data/cleaned_file_Asyl_DE_info.csv", delim = ";")

colnames(trend_data)[which(names(trend_data) == "deportation_not_allowed_by_law")] <- "deportation_barrier"



# Only ErstantrÃ¤ge - Antragsjahr != Auftragsjahr
# deportation_barrier - Aufenthaltsgenehmigung, soft definitions has to be danger

```

## Application for asylum through the years (BRD)

```{r eruptions, echo=FALSE}

maxR <- max(trend_data$Asl_request)




inputPanel(
  selectInput("n_Year", label = "Year:",
              choices = c(2017:1999), selected = 2017),
)

renderPlot({
  trend_data %>% filter(Year == as.numeric(input$n_Year)) %>% 
    select(Asl_request, denied_Asyl) %>% pivot_longer(cols = c(Asl_request, denied_Asyl), names_to="variable", values_to="value") %>% 
    
  ggplot(aes(x = variable, y=value, fill = variable)) +
  geom_col() + theme_minimal() + ylab("Number of asyl requests") + 
    geom_hline(yintercept= maxR, colour = "lightblue") + xlab("Asyl decisions") +
   scale_color_manual(values = c("blue","orange"), aesthetics = c("colour", "fill"))


  

})


```
```{r chill_Shiny_Cluster, echo=FALSE}




```


